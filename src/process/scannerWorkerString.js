export const workerCode = `var m=require("worker_threads");var l=require("fs/promises"),g=async()=>{try{let i=(await l.readdir("/proc",{withFileTypes:!0})).filter((s)=>s.isDirectory()&&/^\\d+$/.test(s.name)).map(async(s)=>{let o=+s.name;try{let c=await Promise.race([l.readFile(\`/proc/\${o}/cmdline\`,"utf8"),new Promise((r,f)=>setTimeout(()=>f(new Error("Timeout")),100))]);try{if((await l.readFile(\`/proc/\${o}/status\`,"utf8")).includes("State:\\tT"))return null}catch(r){}let n;try{n=await l.readlink(\`/proc/\${o}/cwd\`)}catch(r){}let a=c.split("\\x00").filter((r)=>r.trim()!=="");return a.length?[o,a[0],a.slice(1),n]:null}catch{return null}});return(await Promise.all(i)).filter(Boolean)}catch(t){return console.error("Process discovery error:",t),[]}};var h=require("child_process"),p=()=>new Promise((t)=>h.exec("wmic process get ProcessID,ExecutablePath /format:csv",(i,e)=>{t(e.toString().split(\`\\r
\`).slice(2).map((s)=>{let o=s.trim().split(",").slice(1).reverse();return[parseInt(o[0])||o[0],o[1]]}).filter((s)=>s[1]))}));var P=process.platform==="linux"?g:p,u;function y(t){let e=t.toLowerCase().replaceAll("\\\\","/").split("/");if(/^[a-z]:$/.test(e[0])||e[0]==="")e.shift();let s=[],o=["64",".x64","x64","_64"],c=e.length+1;s.length=c*(o.length+1);let n=0;for(let a=0;a<e.length||a===1;a++){let r=e.slice(-a).join("/");s[n++]=r;for(let f of o)if(r.includes(f))s[n++]=r.replace(f,"")}return s.filter(Boolean)}function w(t,i,e,s){if(!t)return!1;if(!(!t.a||e&&e.includes(t.a)))return!1;return t.n.some((c)=>{if(c[0]===">")return c.substring(1)===i[0];return i.some((n)=>c===n||s&&\`\${s}/\${n}\`.includes(\`/\${c}\`))})}async function x(){try{let t=await P(),i=new Set;for(let[e,s,o,c=""]of t){let n=y(s);for(let{e:a,i:r,n:f}of u)try{if(w(a,n,o,c))i.add({id:r,name:f,pid:e})}catch(b){}}m.parentPort.postMessage({type:"scan_results",games:Array.from(i)})}catch(t){m.parentPort.postMessage({type:"error",error:t.message})}}m.parentPort.on("message",async(t)=>{switch(t.type){case"init":u=t.detectable,m.parentPort.postMessage({type:"initialized"});break;case"scan":await x();break}});
`;