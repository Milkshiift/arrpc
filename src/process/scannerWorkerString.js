export const workerCode = `var m=require("worker_threads");var l=require("fs/promises"),g=async()=>{try{let i=(await l.readdir("/proc",{withFileTypes:!0})).filter((t)=>t.isDirectory()&&/^\\d+$/.test(t.name)).map(async(t)=>{let o=+t.name;try{let c=await Promise.race([l.readFile(\`/proc/\${o}/cmdline\`,"utf8"),new Promise((r,f)=>setTimeout(()=>f(new Error("Timeout")),100))]);try{if((await l.readFile(\`/proc/\${o}/status\`,"utf8")).includes("State:\\tT"))return null}catch(r){}let n;try{n=await l.readlink(\`/proc/\${o}/cwd\`)}catch(r){}let a=c.split("\\x00").filter((r)=>r.trim()!=="");return a.length?[o,a[0],a.slice(1),n]:null}catch{return null}});return(await Promise.all(i)).filter(Boolean)}catch(s){return console.error("Process discovery error:",s),[]}};var h=require("child_process"),p=()=>new Promise((s)=>h.exec("wmic process get ProcessID,ExecutablePath /format:csv",(i,e)=>{s(e.toString().split(\`\\r
\`).slice(2).map((t)=>{let o=t.trim().split(",").slice(1).reverse();return[parseInt(o[0])||o[0],o[1]]}).filter((t)=>t[1]))}));var P=process.platform==="linux"?g:p,u;function y(s){let e=s.toLowerCase().replaceAll("\\\\","/").split("/");if(/^[a-z]:$/.test(e[0])||e[0]==="")e.shift();let t=[],o=["64",".x64","x64","_64"],c=e.length+1;t.length=c*(o.length+1);let n=0;for(let a=0;a<e.length||a===1;a++){let r=e.slice(-a).join("/");t[n++]=r;for(let f of o)if(r.includes(f))t[n++]=r.replace(f,"")}return t.filter(Boolean)}function w(s,i,e,t){if(!s)return!1;if(!(!s.a||e&&e.includes(s.a)))return!1;return s.n.some((c)=>{if(c[0]===">")return c.substring(1)===i[0];return i.some((n)=>c===n||t&&\`\${t}/\${n}\`.includes(\`/\${c}\`))})}async function x(){try{let s=await P(),i=new Set;for(let[e,t,o,c=""]of s){let n=y(t);for(let{e:a,i:r,n:f}of u)if(w(a,n,o,c))i.add({id:r,name:f,pid:e})}m.parentPort.postMessage({type:"scan_results",games:Array.from(i)})}catch(s){m.parentPort.postMessage({type:"error",error:s.message})}}m.parentPort.on("message",async(s)=>{switch(s.type){case"init":u=s.detectable,m.parentPort.postMessage({type:"initialized"});break;case"scan":await x();break}});
`;